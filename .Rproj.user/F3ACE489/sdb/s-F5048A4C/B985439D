{
    "collab_server" : "",
    "contents" : "---\ntitle: 'De Novo Diabetes After Pancreatic Resection: Incidence and Risk Factors'\nauthor: \"Anthony Morada\"\ndate: \"April 26, 2016\"\noutput: pdf_document\n---\n\n```{r echo=FALSE,results='hide',warning=FALSE,error=FALSE, message=FALSE}\nknitr::opts_chunk$set(echo=FALSE)\npackages <- c('rvest', 'dplyr', 'pipeR', 'knitr', 'ggplot2', 'xlsx', 'survival', 'moments')\nlapply(packages, library, character.only =T)\nsetwd(\"~/DeNovo_Diabetes_Prsx\")\n```\n\n```{r}\ndf <- read.csv(\"./dndmfinal.csv\")\n```\n\n```{r}\ndf$MRN <- as.character(df$MRN)\nfor(i in 1:nrow(df)){\n        if(nchar(df$MRN[i])!= 9){\n                df$MRN[i] <- paste0(paste(replicate(9-nchar(df$MRN[i]), \"0\"), collapse = \"\"), df$MRN[i])\n        }\n}\ndf$MRN <- as.character(df$MRN)\n```\n\n```{r}\ndf$SURGERY.SIMPLE <- NA\nfor(i in 1:nrow(df)){\n        if(grepl(\"distal panc\", df$SURGERY[i]) == TRUE){\n                df$SURGERY.SIMPLE[i] <- \"Distal Panc\"\n        } else\n                df$SURGERY.SIMPLE[i] <- \"Whipple\"\n}\ndf$SURGERY.SIMPLE <- as.factor(df$SURGERY.SIMPLE)\n```\n\n```{r}\ndf$DM.POS.DATE <- as.Date(df$DM.POS.DATE, \"%m/%d/%Y\")\ndf$FOLLOWUP.DATE <- as.Date(df$FOLLOWUP.DATE, \"%m/%d/%Y\")\ndf$DNDM <- NA\n\n\n\nfor(i in 1:nrow(df)){\n        if(is.na(df$DM.POS.DATE[i]) == TRUE){\n                df$DM.POS.DATE[i] <- df$FOLLOWUP.DATE[i]\n                df$DNDM[i] <- FALSE\n        } else\n                df$DNDM[i] <- TRUE\n}\n```\n\n```{r}\ndf$BMI.30 <- NA\nfor(i in 1:nrow(df)){\n        if(df$BMI[i] >= 30)\n                df$BMI.30[i] <- TRUE\n        else\n                df$BMI.30[i] <- FALSE\n}\n```\n\n\n```{r}\ndf$PATH.CARCINOMA <- NA\nfor(i in 1:nrow(df)){\n        if (grepl(\"carcin\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE | grepl(\"tumor\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE){\n                df$PATH.CARCINOMA[i] <- TRUE\n         } else\n                 df$PATH.CARCINOMA[i] <- FALSE\n}\n\n\n\n\ndf$PATH.ADENOCARCINOMA <- NA\nfor(i in 1:nrow(df)){\n        if (grepl(\"adenocar\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE){\n                df$PATH.ADENOCARCINOMA[i] <- TRUE\n         } else\n                 df$PATH.ADENOCARCINOMA[i] <- FALSE\n}\n\n\ndf$PATH.CYST <- NA\nfor(i in 1:nrow(df)){\n        if (grepl(\"cyst\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE | grepl(\"neopl\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE){\n                df$PATH.CYST[i] <- TRUE\n        } else\n                df$PATH.CYST[i] <- FALSE\n}\n\ndf$PATH.NET <- NA\nfor(i in 1:nrow(df)){\n        if (grepl(\"neuro\", df$PATH.FINAL[i], ignore.case = TRUE) == TRUE){\n                df$PATH.NET[i] <- TRUE\n         } else\n                 df$PATH.NET[i] <- FALSE\n}\n```\n\n## Abstract\n\nThe risk of new onset diabetes mellitus (DM) after pancreatic resection is difficult to estimate because of variability in diagnostic criteria and follow-up. We evaluated 179 consecutive patients undergoing pancreatic resection over a 5 year period to determine the risk of de-novo DM. This was a retrospective review with mean follow-up of 31.3 months. DM was diagnosed according to American Diabetic Association criteria. Of these 179 patients, 127 were free of DM at the time of surgery. DM developed in 36 out of these 127 patients (28%), including 23 of the 95 (18.1%) patients undergoing pancreaticoduodenectomy (PD) and 13 of the 32 (40.6%) undergoing distal pancreatectomy (DP). Onset of DM occurred at 22.9 +/- 18.6 mo. after PD and 26.6 +/- 14.5 mo. after DP. Risk factors for DM included smoking (p = 0.03) and type of pancreatic resection (p << 0.05), whereas ethnicity, age, and BMI were not associated with DM. In 24 of 36 (66.7%) cases of de-novo DM, the onset occurred > 12 months after surgery. Our results show that when subjected to diligent follow-up, the risk of DM after PD and DP is substantial and is affected by tobacco use and type of resection. Long term patient follow-up is critical.  \n\n\n\\break\n\n## Survival Analysis\n\nEndpoint = Expiration\n\n```{r}\ndf$survKM.obj <- with(df, Surv(FOLLOWUP, EXPIRED == TRUE))\nkm.surv <- survfit(survKM.obj ~ 1, data = df, conf.type=\"log\")\nplot(km.surv, xlab=\"Time (Months)\", ylab=\"Survival Probability\", main=\"Kaplan-Meier Survival Analysis for All Patients\")\nkm.surv\n```\n\n\\break\n\n```{r}\nkm.surv.DM <- survfit(survKM.obj ~ DM.STATUS, data = df, conf.type=\"log\")\nplot(km.surv.DM, lty=c(1,2,3), xlab=\"Time (Months)\", ylab=\"Survival Probability\", main=\"Kaplan-Meier Survival Analysis by DM Status\")\nlegend(3, .4, c(\"De Novo DM\", \"No DM\", \"Preop DM\") , lty=c(1,2,3))\nsummary(df$DM.STATUS)\n\nkm.surv.DM\n```\n\nLog-Rank Test on Survival Curves\n```{r}\nsurvdiff(survKM.obj ~ DM.STATUS, data=df)\n```\n\n\n\\break\n\n```{r}\ndf$GROUP <- NA\nfor(i in 1:nrow(df)){\n        if (df$DM.STATUS[i] == 'preop'){\n                df$GROUP[i] <- 'PREOPDM'\n         } else\n                 df$GROUP[i] <- 'STUDY'\n}\n\n```\n\n\n```{r}\nkm.surv.GROUP <- survfit(survKM.obj ~ GROUP, data = df, conf.type=\"log\")\nplot(km.surv.GROUP, lty=c(1,2,3), xlab=\"Time (Months)\", ylab=\"Survival Probability\", main=\"Kaplan-Meier Survival Analysis by Study Group\")\nlegend(3, .4, c(\"PREOPDM\", \"STUDY\") , lty=c(1,3))\nsummary(df$GROUP)\n\nkm.surv.GROUP\n```\n\nLog-Rank Test on Survival Curves: Control vs Study Group\n```{r}\nsurvdiff(survKM.obj ~ GROUP, data=df)\n```\n\n\n\n\\break\n\n\n## DNDM Followup Time\n\nEndpoint = De Novo DM emergence  \nExcluded: Patients with preoperative DM\n\n```{r}\ndf$DOS <- as.Date(df$DOS, \"%m/%d/%Y\")\ndf$DM.FOLLOWUP <- as.numeric((df$DM.POS.DATE - df$DOS)/30.4167)\ndf$DMKM.obj <- with(df, Surv(DM.FOLLOWUP, DNDM == TRUE))\n\ndm <- subset(df, df$DM.STATUS != 'preop') ##Excluding Pts with preop DM\nkm.DM <- survfit(DMKM.obj ~ 1, data = dm, conf.type=\"log\")\nplot(km.DM, xlab=\"Time (Months)\", ylab=\"De Novo DM Free Probability\", main=\"Diabetes Free Kaplan-Meier Survival Analysis for All Patients\")\nkm.DM\n```\n\n```{r}\nkm.DMSURG <- survfit(DMKM.obj ~ SURGERY.SIMPLE, data = dm, conf.type=\"log\")\nplot(km.DMSURG, lty=c(1,2), xlab=\"Time (Months)\", ylab=\"De Novo DM Free Probability\", main=\"Diabetes Free Kaplan-Meier Survival Analysis by OP\")\nlegend(3, .2, c(\"Distal Pancreatectomy\", \"Pancreaticoduodenectomy\") , lty=c(1,2))\nsummary(dm$SURGERY.SIMPLE)\nkm.DMSURG\n```\n\nLog-Rank Test on Diabetes Free Survival Curves\n```{r}\nsurvdiff(DMKM.obj ~ SURGERY.SIMPLE, data=dm)\n```\n\n\\break\n\n## Cox Proportional-Hazards Regression\n\n```{r}\nmod.dndm <- coxph(Surv(DM.FOLLOWUP, DNDM) ~\n                          AGE.60 + PATH.CARCINOMA + SURGERY.SIMPLE + NONCAUCASIAN + HX.SMOKING + BMI.30 + GENDER,\n                  data =dm)\nsummary(mod.dndm)\n```\n\n\n```{r}\nmod.surv <- coxph(Surv(DM.FOLLOWUP, EXPIRED) ~\n                          AGE.60 + PATH.CARCINOMA + SURGERY.SIMPLE + NONCAUCASIAN + HX.SMOKING + BMI.30 + GENDER,\n                  data =dm)\nsummary(mod.surv)\n```\n\n\n\\break\n\n```{r}\ndndm <- subset(dm, dm$DM.STATUS == 'de novo')\ndndm.dpanc <- subset(dndm, dndm$SURGERY.SIMPLE == 'Distal Panc')\ndndm.whip <- subset(dndm, dndm$SURGERY.SIMPLE == 'Whipple')\n```\n\n",
    "created" : 1491954360317.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4230669413",
    "id" : "B985439D",
    "lastKnownWriteTime" : 1488907559,
    "last_content_update" : 1488907559,
    "path" : "~/DeNovo_Diabetes_Prsx/DNDM.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}